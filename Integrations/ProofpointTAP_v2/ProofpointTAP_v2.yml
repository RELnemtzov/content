category: Email Gateway
commonfields:
  id: Proofpoint TAP v2
  version: -1
configuration:
- defaultvalue: https://tap-api-v2.proofpoint.com
  display: Server URL (e.g., https://tap-api-v2.proofpoint.com)
  name: url
  required: true
  type: 0
- display: Service Principal (the Password refers to Secret)
  name: credentials
  required: true
  type: 9
- defaultvalue: v2
  display: API Version
  name: api_version
  options:
  - v1
  - v2
  required: false
  type: 15
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- display: A string specifying which threat type to return. If empty, all threat types
    are returned. Can be "url", "attachment", or "messageText".
  name: threat_type
  options:
  - url
  - attachment
  - messageText
  required: false
  type: 16
- display: A string specifying which threat statuses to return. If empty, will return
    "active" and "cleared" threats.
  name: threat_status
  options:
  - active
  - cleared
  - falsePositive
  required: false
  type: 16
- defaultvalue: All
  display: Events to fetch
  name: events_type
  options:
  - All
  - Issues
  - Blocked Clicks
  - Permitted Clicks
  - Blocked Messages
  - Delivered Messages
  required: false
  type: 15
- defaultvalue: 1 hour
  display: First fetch time range (<number> <time unit>, e.g., 1 hour, 30 minutes)
    - Proofpoint supports maximum 1 hour fetch back
  name: fetch_time
  required: false
  type: 0
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
description: Use the Proofpoint Targeted Attack Protection (TAP) integration to protect
  against and provide additional visibility into phishing and other malicious email
  attacks.
display: Proofpoint TAP v2
name: Proofpoint TAP v2
script:
  commands:
  - arguments:
    - default: false
      description: 'A string containing an ISO8601-formatted interval. If this interval
        overlaps with previous requests for data, records from the previous request
        might be duplicated. The minimum interval is thirty seconds. The maximum interval
        is one hour. Examples:  2016-05-01T12:00:00Z/2016-05-01T13:00:00Z - an hour
        interval, beginning at noon UTC on 05-01-2016 PT30M/2016-05-01T12:30:00Z -
        the thirty minutes beginning at noon UTC on 05-01-2016 and ending at 12:30pm
        UTC 2016-05-01T05:00:00-0700/PT30M - the same interval as above, but using
        -0700 as the time zone'
      isArray: false
      name: interval
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: 'A string specifying which threat type to return. If empty, all
        threat types are returned. The following values are accepted: url,attachment,
        messageText'
      isArray: false
      name: threatType
      predefined:
      - url
      - attachment
      - messageText
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: A string specifying which threat statuses to return. If empty,
        active and cleared threats are returned. Can be "active", "cleared", "falsePositive".
      isArray: false
      name: threatStatus
      predefined:
      - active
      - cleared
      - falsePositive
      required: false
      secret: false
    - default: false
      description: 'A string containing an ISO8601 date. It represents the start of
        the data retrieval period. The end of the period is determined by the current
        API server time rounded to the nearest minute. If JSON output is selected,
        the end time is included in the returned result. Example: 2016-05-01T12:00:00Z'
      isArray: false
      name: sinceTime
      required: false
      secret: false
    - default: false
      description: An integer representing a time window (in seconds) from the current
        API server time. The start of the window is the current API server time, rounded
        to the nearest minute, less the number of seconds provided. The end of the
        window is the current API server time rounded to the nearest minute. If JSON
        output is selected, the end time is included in the returned result.
      isArray: false
      name: sinceSeconds
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: All
      description: Event types to return.
      isArray: false
      name: eventTypes
      predefined:
      - All
      - Issues
      - Delivered Messages
      - Blocked Messages
      - Permitted Clicks
      - Blocked Clicks
      required: false
      secret: false
    deprecated: false
    description: Fetches events for all clicks and messages relating to known threats
      within the specified time period. Details as per clicks/blocked.
    execution: false
    name: proofpoint-get-events
  - arguments:
    - default: false
      description: ID of threat (must fill threadId or campaignId)
      isArray: false
      name: threatId
      required: false
      secret: false
    - default: false
      description: ID of campaign (must fill threadId or campaignId)
      isArray: false
      name: campaignId
      required: false
      secret: false
    - default: false
      defaultValue: 'false'
      description: Can be provide only with threatId
      isArray: false
      name: includeCampaignForensics
      required: false
      secret: false
    deprecated: false
    description: get forensic evidence
    execution: false
    name: proofpoint-get-forensic
    outputs:
    - contextPath: Proofpoint.Report.ID
      description: ID of report
      type: String
    - contextPath: Proofpoint.Report.Type
      description: 'The threat type: attachment, url, or hybrid'
      type: String
    - contextPath: Proofpoint.Report.Scope
      description: Whether the report scope covers a campaign or an individual threat
      type: String
    - contextPath: Proofpoint.Report.Attachment.Time
      description: The relative time at which the evidence was observed during sandboxing.
      type: Date
    - contextPath: Proofpoint.Report.Attachment.Malicious
      description: whether the evidence was used to reach a malicious verdict.
      type: String
    - contextPath: Proofpoint.Report.Attachment.Display
      description: A friendly display string.
      type: String
    - contextPath: Proofpoint.Report.Attachment.SHA256
      description: The SHA256 hash of the attachment's contents.
      type: String
    - contextPath: Proofpoint.Report.Attachment.MD5
      description: The MD5 hash of the attachment's contents.
      type: String
    - contextPath: Proofpoint.Report.Attachment.Blacklisted
      description: Optional, whether the file was blacklisted.
      type: Number
    - contextPath: Proofpoint.Report.Attachment.Offset
      description: Optional, the offset in bytes where the malicious content was found.
      type: Number
    - contextPath: Proofpoint.Report.Attachment.Size
      description: Optional, the size in bytes of the attachment's contents.
      type: Number
    - contextPath: Proofpoint.Report.Attachment.Platform.Name
      description: Name of the platform.
      type: String
    - contextPath: Proofpoint.Report.Attachment.Platform.OS
      description: OS of the platform.
      type: String
    - contextPath: Proofpoint.Report.Attachment.Platform.Version
      description: Version of the platform.
      type: String
    - contextPath: Proofpoint.Report.Cookie.Time
      description: The relative time at which the evidence was observed during sandboxing.
      type: Date
    - contextPath: Proofpoint.Report.Cookie.Malicious
      description: whether the evidence was used to reach a malicious verdict.
      type: String
    - contextPath: Proofpoint.Report.Cookie.Display
      description: A friendly display string.
      type: String
    - contextPath: Proofpoint.Report.Cookie.Action
      description: Whether the cookie was set or deleted
      type: String
    - contextPath: Proofpoint.Report.Cookie.Domain
      description: Which domain set the cookie.
      type: String
    - contextPath: Proofpoint.Report.Cookie.Key
      description: The name of the cookie being set or deleted.
      type: String
    - contextPath: Proofpoint.Report.Cookie.Value
      description: Optional, content of the cookie being set.
      type: String
    - contextPath: Proofpoint.Report.Cookie.Platform.Name
      description: Name of the platform.
      type: String
    - contextPath: Proofpoint.Report.Cookie.Platform.OS
      description: OS of the platform.
      type: String
    - contextPath: Proofpoint.Report.Cookie.Platform.Version
      description: Version of the platform.
      type: String
    - contextPath: Proofpoint.Report.DNS.Time
      description: The relative time at which the evidence was observed during sandboxing.
      type: Date
    - contextPath: Proofpoint.Report.DNS.Malicious
      description: whether the evidence was used to reach a malicious verdict.
      type: String
    - contextPath: Proofpoint.Report.DNS.Display
      description: A friendly display string.
      type: String
    - contextPath: Proofpoint.Report.DNS.Host
      description: The hostname being resolved.
      type: String
    - contextPath: Proofpoint.Report.DNS.CNames
      description: Optional, an array of cnames which were associated with the hostname.
      type: String
    - contextPath: Proofpoint.Report.DNS.IP
      description: Optional, an array of IP addresses which were resolved to the hostname.
      type: String
    - contextPath: Proofpoint.Report.DNS.NameServers
      description: Optional, the nameservers responsible for the hostname's domain.
      type: String
    - contextPath: Proofpoint.Report.DNS.NameServersList
      description: Optional, the nameservers responsible for the hostname's.
      type: String
    - contextPath: Proofpoint.Report.DNS.Platform.Name
      description: Name of the platform.
      type: String
    - contextPath: Proofpoint.Report.DNS.Platform.OS
      description: OS of the platform.
      type: String
    - contextPath: Proofpoint.Report.DNS.Platform.Version
      description: Version of the platform.
      type: String
    - contextPath: Proofpoint.Report.Dropper.Time
      description: The relative time at which the evidence was observed during sandboxing.
      type: Date
    - contextPath: Proofpoint.Report.Dropper.Malicious
      description: whether the evidence was used to reach a malicious verdict.
      type: String
    - contextPath: Proofpoint.Report.Dropper.Display
      description: A friendly display string.
      type: String
    - contextPath: Proofpoint.Report.Dropper.Path
      description: The location of the dropper file.
      type: String
    - contextPath: Proofpoint.Report.Dropper.URL
      description: Optional, the name of the static rule inside the sandbox which
        identified the dropper.
      type: String
    - contextPath: Proofpoint.Report.Dropper.Rule
      description: Optional, the URL the dropper contacted.
      type: String
    - contextPath: Proofpoint.Report.Dropper.Platform.Name
      description: Name of the platform.
      type: String
    - contextPath: Proofpoint.Report.Dropper.Platform.OS
      description: OS of the platform.
      type: String
    - contextPath: Proofpoint.Report.Dropper.Platform.Version
      description: Version of the platform.
      type: String
    - contextPath: Proofpoint.Report.File.Time
      description: The relative time at which the evidence was observed during sandboxing.
      type: Date
    - contextPath: Proofpoint.Report.File.Malicious
      description: whether the evidence was used to reach a malicious verdict.
      type: String
    - contextPath: Proofpoint.Report.File.Display
      description: A friendly display string.
      type: String
    - contextPath: Proofpoint.Report.File.Path
      description: Optional, the location of the file operated on.
      type: String
    - contextPath: Proofpoint.Report.File.Action
      description: Optional, the filesystem call made create (modify, or delete).
      type: String
    - contextPath: Proofpoint.Report.File.Rule
      description: Optional, the name of the static rule inside the sandbox which
        identified the suspicious file.
      type: String
    - contextPath: Proofpoint.Report.File.SHA256
      description: Optional, the SH256 sum of the file's contents.
      type: Unknown
    - contextPath: Proofpoint.Report.File.MD5
      description: Optional, the MD5 sum of the file's contents.
      type: String
    - contextPath: Proofpoint.Report.File.Size
      description: Optional, the size in bytes of the file's contents.
      type: Number
    - contextPath: Proofpoint.Report.File.Platform.Name
      description: Name of the platform.
      type: String
    - contextPath: Proofpoint.Report.File.Platform.OS
      description: OS of the platform.
      type: String
    - contextPath: Proofpoint.Report.File.Platform.Version
      description: Version of the platform.
      type: String
    - contextPath: Proofpoint.Report.IDS.Time
      description: The relative time at which the evidence was observed during sandboxing.
      type: Date
    - contextPath: Proofpoint.Report.IDS.Malicious
      description: whether the evidence was used to reach a malicious verdict.
      type: String
    - contextPath: Proofpoint.Report.IDS.Display
      description: A friendly display string.
      type: String
    - contextPath: Proofpoint.Report.IDS.Name
      description: The friendly name of the IDS rule which observed the malicious
        traffic.
      type: String
    - contextPath: Proofpoint.Report.IDS.SignatureID
      description: The identifier of the IDS rule which observed the malicious traffic.
      type: String
    - contextPath: Proofpoint.Report.IDS.Platform.Name
      description: Name of the platform.
      type: String
    - contextPath: Proofpoint.Report.IDS.Platform.OS
      description: OS of the platform.
      type: String
    - contextPath: Proofpoint.Report.IDS.Platform.Version
      description: Version of the platform.
      type: String
    - contextPath: Proofpoint.Report.Mutex.Time
      description: The relative time at which the evidence was observed during sandboxing.
      type: Date
    - contextPath: Proofpoint.Report.Mutex.Malicious
      description: whether the evidence was used to reach a malicious verdict.
      type: String
    - contextPath: Proofpoint.Report.Mutex.Display
      description: A friendly display string.
      type: String
    - contextPath: Proofpoint.Report.Mutex.Name
      description: The name of the mutex.
      type: String
    - contextPath: Proofpoint.Report.Mutex.Path
      description: Optional, the path to the process which spawned the mutex.
      type: String
    - contextPath: Proofpoint.Report.Mutex.Platform.Name
      description: Name of the platform.
      type: String
    - contextPath: Proofpoint.Report.Mutex.Platform.OS
      description: OS of the platform.
      type: String
    - contextPath: Proofpoint.Report.Mutex.Platform.Version
      description: Version of the platform.
      type: String
    - contextPath: Proofpoint.Report.Network.Time
      description: The relative time at which the evidence was observed during sandboxing.
      type: Date
    - contextPath: Proofpoint.Report.Network.Malicious
      description: whether the evidence was used to reach a malicious verdict.
      type: String
    - contextPath: Proofpoint.Report.Network.Display
      description: A friendly display string.
      type: String
    - contextPath: Proofpoint.Report.Network.Action
      description: The type of network activity being initated (connect or listen).
      type: String
    - contextPath: Proofpoint.Report.Network.IP
      description: The remote IP address being contacted.
      type: String
    - contextPath: Proofpoint.Report.Network.Port
      description: The remote IP Port being contacted.
      type: String
    - contextPath: Proofpoint.Report.Network.Type
      description: The protocol being used (tcp or udp).
      type: String
    - contextPath: Proofpoint.Report.Network.Platform.Name
      description: Name of the platform.
      type: String
    - contextPath: Proofpoint.Report.Network.Platform.OS
      description: OS of the platform.
      type: String
    - contextPath: Proofpoint.Report.Network.Platform.Version
      description: Version of the platform.
      type: String
    - contextPath: Proofpoint.Report.Process.Time
      description: The relative time at which the evidence was observed during sandboxing.
      type: Date
    - contextPath: Proofpoint.Report.Process.Malicious
      description: whether the evidence was used to reach a malicious verdict.
      type: String
    - contextPath: Proofpoint.Report.Process.Display
      description: A friendly display string.
      type: String
    - contextPath: Proofpoint.Report.Process.Action
      description: The action peformed on the process, current only create is produced.
      type: String
    - contextPath: Proofpoint.Report.Process.Path
      description: The location of the executable which spawned the process.
      type: String
    - contextPath: Proofpoint.Report.Process.Platform.Name
      description: Name of the platform.
      type: String
    - contextPath: Proofpoint.Report.Process.Platform.OS
      description: OS of the platform.
      type: String
    - contextPath: Proofpoint.Report.Process.Platform.Version
      description: Version of the platform.
      type: String
    - contextPath: Proofpoint.Report.Registry.Time
      description: The relative time at which the evidence was observed during sandboxing.
      type: Date
    - contextPath: Proofpoint.Report.Registry.Malicious
      description: whether the evidence was used to reach a malicious verdict.
      type: String
    - contextPath: Proofpoint.Report.Registry.Display
      description: A friendly display string.
      type: String
    - contextPath: Proofpoint.Report.Registry.Name
      description: Optional, the name of the registry entry being created or set.
      type: String
    - contextPath: Proofpoint.Report.Registry.Action
      description: The registry change made (create or set).
      type: String
    - contextPath: Proofpoint.Report.Registry.Key
      description: The location of the registry key being modified.
      type: String
    - contextPath: Proofpoint.Report.Registry.Value
      description: Optional, the contents of the key being created or set.
      type: String
    - contextPath: Proofpoint.Report.Registry.Platform.Name
      description: Name of the platform.
      type: String
    - contextPath: Proofpoint.Report.Registry.Platform.OS
      description: OS of the platform.
      type: String
    - contextPath: Proofpoint.Report.Registry.Platform.Version
      description: Version of the platform.
      type: String
    - contextPath: Proofpoint.Report.URL.Time
      description: The relative time at which the evidence was observed during sandboxing.
      type: Date
    - contextPath: Proofpoint.Report.URL.Malicious
      description: whether the evidence was used to reach a malicious verdict.
      type: String
    - contextPath: Proofpoint.Report.URL.Display
      description: A friendly display string.
      type: String
    - contextPath: Proofpoint.Report.URL.URL
      description: The URL which was observed.
      type: String
    - contextPath: Proofpoint.Report.URL.Blacklisted
      description: Optional, whether the URL was listed on a blacklist.
      type: Boolean
    - contextPath: Proofpoint.Report.URL.SHA256
      description: Optional, the sha256 value of the file downloaded from the URL.
      type: String
    - contextPath: Proofpoint.Report.URL.MD5
      description: Optional, the md5 value of the file downloaded from the URL.
      type: String
    - contextPath: Proofpoint.Report.URL.Size
      description: Optional, the size in bytes of the file retrieved from the URL.
      type: Number
    - contextPath: Proofpoint.Report.URL.HTTPStatus
      description: Optional, the HTTP status code which was produced when our sandbox
        visited the URL.
      type: Number
    - contextPath: Proofpoint.Report.URL.IP
      description: Optional, the IP address that was resolved to the hostname by the
        sandbox.
      type: String
    - contextPath: Proofpoint.Report.URL.Platform.Name
      description: Name of the platform.
      type: String
    - contextPath: Proofpoint.Report.URL.Platform.OS
      description: OS of the platform.
      type: String
    - contextPath: Proofpoint.Report.URL.Platform.Version
      description: Version of the platform.
      type: String
  dockerimage: demisto/python3:3.7.4.977
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- No test - no instance
